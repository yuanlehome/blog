---
import { normalizeBase } from '../lib/slug';

interface Props {
  name: string;
  slug: string;
  count?: number;
  size?: 'sm' | 'md';
  variant?: 'default' | 'count-badge';
}

const BASE = normalizeBase(import.meta.env.BASE_URL);
const { name, slug, count, size = 'sm', variant = 'default' } = Astro.props;

const sizeClasses = {
  sm: 'text-xs px-2 py-1',
  md: 'text-sm px-3 py-1.5',
};

const href = `${BASE}tags/${slug}/`;
---

<a
  href={href}
  class={`tag-chip inline-flex items-center gap-1.5 rounded-full border transition-all duration-200 font-medium cursor-pointer ${sizeClasses[size]} 
    border-pink-500/30 bg-pink-900/20 text-pink-300 hover:bg-pink-900/40 hover:border-pink-400 hover:shadow-[0_0_12px_rgba(236,72,153,0.3)]
    dark:border-pink-400/40 dark:bg-pink-950/30 dark:text-pink-200 dark:hover:bg-pink-950/50 dark:hover:border-pink-300 dark:hover:shadow-[0_0_16px_rgba(244,114,182,0.4)]
    focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-pink-400 focus-visible:ring-offset-2 dark:focus-visible:ring-offset-zinc-900`}
  data-tag-slug={slug}
  data-testid={`tag-${slug}`}
>
  <span class="tag-name pointer-events-none">{name}</span>
  {
    variant === 'count-badge' && count !== undefined && (
      <span class="tag-count inline-flex items-center justify-center min-w-[1.25rem] h-5 px-1.5 rounded-full text-[0.7rem] font-semibold bg-pink-500/20 text-pink-200 dark:bg-pink-400/20 dark:text-pink-100 pointer-events-none">
        {count}
      </span>
    )
  }
</a>
